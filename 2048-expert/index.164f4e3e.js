class e{#e;constructor(e){e.style.setProperty("--grid-size",6),e.style.setProperty("--cell-size","10vmin"),e.style.setProperty("--cell-gap","1.5vmin"),this.#e=function(e){const t=[];for(let l=0;l<36;l++){const l=document.createElement("div");l.classList.add("cell"),t.push(l),e.append(l)}return t}(e).map(((e,l)=>new t(e,l%6,Math.floor(l/6))))}get cells(){return this.#e}get cellsByRow(){return this.#e.reduce(((e,t)=>(e[t.y]=e[t.y]||[],e[t.y][t.x]=t,e)),[])}get cellsByColumn(){return this.#e.reduce(((e,t)=>(e[t.x]=e[t.x]||[],e[t.x][t.y]=t,e)),[])}get#t(){return this.#e.filter((e=>null==e.tile))}checkAvailableCell(){return 0!==this.#t.length}randomEmptyCell(){const e=Math.floor(Math.random()*this.#t.length);return this.#t[e]}}class t{#l;#r;#n;#i;#s;constructor(e,t,l){this.#l=e,this.#r=t,this.#n=l}get x(){return this.#r}get y(){return this.#n}get tile(){return this.#i}set tile(e){this.#i=e,null!=e&&(this.#i.x=this.#r,this.#i.y=this.#n)}get mergeTile(){return this.#s}set mergeTile(e){this.#s=e,null!=e&&(this.#s.x=this.#r,this.#s.y=this.#n)}canAccept(e){return null==this.tile||null==this.mergeTile&&this.tile.value===e.value}mergeTiles(){var e;null!=this.tile&&null!=this.mergeTile&&(this.tile.value=this.tile.value+this.mergeTile.value,e=this.tile.value,currentScore+=e,l.innerHTML=currentScore,currentScore>parseInt(n)&&(setBestScore(currentScore),r.innerHTML=currentScore),this.mergeTile.remove(),this.mergeTile=null,2048==this.tile.value&&setTimeout((()=>alert("You won!")),1))}}const l=document.getElementById("current-score"),r=document.getElementById("best-score");window.currentScore=0;let n=null===getBestScore()?0:getBestScore();r.innerHTML=n;class i{#o;#r;#n;#c;constructor(e,t=(Math.random()>.5?2:4)){this.#o=document.createElement("div"),this.#o.classList.add("tile"),e.append(this.#o),this.value=t}get value(){return this.#c}set value(e){switch(this.#c=e,this.#o.textContent=e,this.#o.textContent){case"":case"0":this.#o.style.backgroundColor="#afa184",this.#o.style.style.colour="rgb(175, 161, 132)";break;case"2":this.#o.style.backgroundColor="#eee4ea";break;case"4":this.#o.style.backgroundColor="#ede2c8";break;case"8":this.#o.style.backgroundColor="#f2b179";break;case"16":this.#o.style.backgroundColor="#ffceaa";break;case"32":this.#o.style.backgroundColor="#e8c083";break;case"64":this.#o.style.backgroundColor="#ffab6e";break;case"128":this.#o.style.backgroundColor="#fd9787";break;case"256":this.#o.style.backgroundColor="#eah89c";break;case"512":this.#o.style.backgroundColor="#76daff";break;case"1024":this.#o.style.backgroundColor="#beeaab";break;case"2048":this.#o.style.backgroundColor="#d7d0f0"}}set x(e){this.#r=e,this.#o.style.setProperty("--x",e)}set y(e){this.#n=e,this.#o.style.setProperty("--y",e)}remove(){this.#o.remove()}waitForTransition(e=!1){return new Promise((t=>{this.#o.addEventListener(e?"animationend":"transitionend",t,{once:!0})}))}}const s=document.getElementById("game-board"),o=document.getElementById("current-score");document.getElementById("new-btn").onclick=function(){gameEnd=!1,s.textContent="",window.currentScore=0,o.innerHTML=0,a()};var c=new e(s);function a(){(c=new e(s)).randomEmptyCell().tile=new i(s),c.randomEmptyCell().tile=new i(s),u()}function u(){window.addEventListener("keydown",m,{once:!0})}async function m(e){switch(e.key){case"ArrowUp":case"w":if(!y())return void u();await h(c.cellsByColumn);break;case"ArrowDown":case"s":if(!d())return void u();await h(c.cellsByColumn.map((e=>[...e].reverse())));break;case"ArrowLeft":case"a":if(!g())return void u();await h(c.cellsByRow);break;case"ArrowRight":case"d":if(!E())return void u();await h(c.cellsByRow.map((e=>[...e].reverse())));break;default:return void u()}c.cells.forEach((e=>e.mergeTiles()));const t=new i(s);if(c.randomEmptyCell().tile=t,c.checkAvailableCell()){const e=new i(s);c.randomEmptyCell().tile=e}y()||d()||g()||E()?u():t.waitForTransition(!0).then((()=>{setTimeout((()=>alert("\t\t You Lost\n Your score is "+currentScore)),1),a()}))}function h(e){return Promise.all(e.flatMap((e=>{const t=[];for(let l=1;l<e.length;l++){const r=e[l];if(null==r.tile)continue;let n;for(let t=l-1;t>=0;t--){const l=e[t];if(!l.canAccept(r.tile))break;n=l}null!=n&&(t.push(r.tile.waitForTransition()),null!=n.tile?n.mergeTile=r.tile:n.tile=r.tile,r.tile=null)}return t})))}function y(){return f(c.cellsByColumn)}function d(){return f(c.cellsByColumn.map((e=>[...e].reverse())))}function g(){return f(c.cellsByRow)}function E(){return f(c.cellsByRow.map((e=>[...e].reverse())))}function f(e){return e.some((e=>e.some(((t,l)=>{if(0===l)return!1;if(null==t.tile)return!1;return e[l-1].canAccept(t.tile)}))))}c.randomEmptyCell().tile=new i(s),c.randomEmptyCell().tile=new i(s),u();
//# sourceMappingURL=index.164f4e3e.js.map
